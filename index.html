<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CI/CD Pipeline Simulation</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: linear-gradient(135deg, #f8fafc 0%, #e2e8f0 100%);
            padding: 60px 20px 20px 20px; /* Top padding for fixed banner */
            min-height: 100vh;
            overflow-x: auto;
        }

        .author-banner {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            padding: 8px 20px;
            background: rgba(0, 0, 0, 0.8);
            color: white;
            font-size: 0.85rem;
            text-align: center;
            z-index: 1000;
            backdrop-filter: blur(10px);
        }

        .author-banner p {
            margin: 0;
            opacity: 0.9;
        }

        .author-banner a {
            color: #84fab0;
            text-decoration: none;
        }

        .author-banner a:hover {
            text-decoration: underline;
        }

        .pipeline-container {
            max-width: 1200px;
            margin: 0 auto;
            background: rgba(255, 255, 255, 0.9);
            border-radius: 20px;
            padding: 30px;
            box-shadow: 0 10px 40px rgba(0,0,0,0.1);
            backdrop-filter: blur(10px);
        }

        .pipeline-title {
            font-size: 28px;
            font-weight: 700;
            margin-bottom: 20px;
            color: #2d3748;
            text-align: center;
        }

        .feature-url-preview {
            text-align: center;
            margin-bottom: 30px;
            padding: 15px 20px;
            background: rgba(255, 255, 255, 0.8);
            border-radius: 12px;
            border: 2px solid #e2e8f0;
            backdrop-filter: blur(10px);
        }

        .feature-url-preview .url {
            font-family: 'Monaco', 'Menlo', monospace;
            font-size: 16px;
            color: #4a5568;
            font-weight: 500;
        }

        .feature-url-preview .status {
            font-size: 14px;
            color: #718096;
            margin-top: 5px;
        }

        .feature-url-preview.deployed {
            border-color: #10b981;
            background: rgba(209, 250, 229, 0.8);
        }

        .feature-url-preview.deployed .status {
            color: #064e3b;
        }

        .pipeline-stages {
            position: relative;
            width: 100%;
            height: 900px;
            margin: 0 auto;
        }

        /* Circular ripple effect in center */
        .pipeline-center {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 220px;
            height: 160px;
            background: #f0f0f0;
            border-radius: 12px;
            display: flex;
            flex-direction: column;
            overflow: hidden;
            box-shadow: 0 8px 25px rgba(0,0,0,0.15);
            z-index: 10;
            border: 3px solid #666;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .pipeline-center.active {
            animation: pulse-center 2s infinite;
        }

        @keyframes pulse-center {
            0% {
                box-shadow: 0 0 0 0 rgba(66, 153, 225, 0.4);
            }
            70% {
                box-shadow: 0 0 0 30px rgba(66, 153, 225, 0);
            }
            100% {
                box-shadow: 0 0 0 0 rgba(66, 153, 225, 0);
            }
        }

        .browser-preview {
            width: 100%;
            height: 100%;
            display: flex;
            flex-direction: column;
            transition: filter 0.5s ease;
        }

        .browser-preview.pending {
            filter: blur(2px) grayscale(0.7) brightness(0.8);
        }

        .browser-preview.loading {
            filter: blur(1px) grayscale(0.3) brightness(0.9);
            animation: pulse-preview 2s infinite;
        }

        .browser-preview.deployed {
            filter: blur(0px) grayscale(0) brightness(1);
        }

        @keyframes pulse-preview {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.02); }
        }

        .mini-browser-header {
            background: linear-gradient(135deg, #4a5568 0%, #2d3748 100%);
            height: 28px;
            display: flex;
            align-items: center;
            padding: 0 10px;
            gap: 6px;
        }

        .mini-window-control {
            width: 10px;
            height: 10px;
            border-radius: 50%;
        }

        .mini-window-control.close { background: #ff5f57; }
        .mini-window-control.minimize { background: #ffbd2e; }
        .mini-window-control.maximize { background: #28ca42; }

        .mini-url-bar {
            flex: 1;
            margin-left: 10px;
            background: rgba(255, 255, 255, 0.15);
            border-radius: 10px;
            height: 16px;
            display: flex;
            align-items: center;
            padding: 0 8px;
            font-size: 9px;
            color: white;
            font-family: monospace;
            text-align: center;
        }

        .mini-browser-content {
            flex: 1;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            display: flex;
            align-items: center;
            justify-content: center;
            position: relative;
        }

        .deployment-status {
            position: absolute;
            top: 6px;
            left: 50%;
            transform: translateX(-50%);
            background: rgba(0,0,0,0.8);
            color: white;
            padding: 4px 8px;
            border-radius: 10px;
            font-size: 11px;
            font-weight: 600;
            z-index: 2;
        }

        .deployment-status.pending {
            background: rgba(113, 128, 150, 0.9);
        }

        .deployment-status.loading {
            background: rgba(251, 191, 36, 0.9);
            color: #1a202c;
        }

        .deployment-status.deployed {
            background: rgba(16, 185, 129, 0.9);
        }

        .mini-content-placeholder {
            color: white;
            font-size: 12px;
            text-align: center;
            opacity: 0.9;
            font-weight: 500;
        }


        /* Stages positioned in a circle */
        .stage {
            position: absolute;
            width: 220px;
            display: flex;
            flex-direction: column;
            align-items: center;
        }

        /* Position stages around the circle - improved spacing to prevent overlap */
        .stage:nth-child(2) { /* lint */
            top: 20px;
            left: calc(50% - 110px);
        }
        .stage:nth-child(3) { /* bump */
            top: 80px;
            right: 80px;
        }
        .stage:nth-child(4) { /* build */
            top: 250px;
            right: 20px;
        }
        .stage:nth-child(5) { /* unit-tests */
            bottom: 280px;
            right: 40px;
        }
        .stage:nth-child(6) { /* components-tests */
            bottom: 180px;
            right: 120px;
        }
        .stage:nth-child(7) { /* e2e-tests */
            bottom: 80px;
            left: calc(50% - 110px);
        }
        .stage:nth-child(8) { /* post-release */
            bottom: 180px;
            left: 120px;
        }
        .stage:nth-child(9) { /* deploy */
            bottom: 280px;
            left: 40px;
        }
        .stage:nth-child(10) { /* post-deploy */
            top: 250px;
            left: 20px;
        }

        .stage-header {
            font-size: 12px;
            font-weight: 600;
            color: #4a5568;
            margin-bottom: 10px;
            text-align: center;
            padding: 6px 12px;
            background: rgba(255, 255, 255, 0.9);
            border-radius: 12px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.2);
        }

        .jobs-container {
            display: flex;
            flex-direction: column;
            gap: 8px;
            align-items: center;
        }

        .job {
            background: rgba(255, 255, 255, 0.95);
            border: 2px solid rgba(226, 232, 240, 0.8);
            border-radius: 12px;
            padding: 10px 12px;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 8px;
            width: 200px;
            min-height: 50px;
            backdrop-filter: blur(10px);
            box-shadow: 0 4px 12px rgba(0,0,0,0.1);
        }

        .job.pending {
            border-color: rgba(113, 128, 150, 0.5);
            background: rgba(247, 250, 252, 0.9);
        }

        .job.running {
            border-color: #fbbf24;
            background: rgba(254, 243, 199, 0.95);
            animation: pulse-job 1.5s infinite;
            box-shadow: 0 0 20px rgba(251, 191, 36, 0.3);
        }

        .job.success {
            border-color: #10b981;
            background: rgba(209, 250, 229, 0.95);
            box-shadow: 0 4px 12px rgba(16, 185, 129, 0.2);
        }

        .job.manual {
            border-color: #8b5cf6;
            background: rgba(237, 233, 254, 0.95);
            box-shadow: 0 4px 12px rgba(139, 92, 246, 0.2);
        }

        @keyframes pulse-job {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.05); }
        }

        .job-icon {
            width: 24px;
            height: 24px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 12px;
            flex-shrink: 0;
        }

        .job.pending .job-icon {
            background: #64748b;
            color: white;
        }

        .job.running .job-icon {
            background: #fbbf24;
            color: white;
        }

        .job.success .job-icon {
            background: #10b981;
            color: white;
        }

        .job.manual .job-icon {
            background: #8b5cf6;
            color: white;
        }

        .job-name {
            font-weight: 500;
            color: #2d3748;
            flex: 1;
            font-size: 11px;
            line-height: 1.3;
            word-wrap: break-word;
            hyphens: auto;
        }

        .job-duration {
            font-size: 10px;
            color: #718096;
        }

        .spinner {
            width: 16px;
            height: 16px;
            border: 2px solid #ffffff;
            border-top: 2px solid transparent;
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        .controls {
            margin-top: 40px;
            text-align: center;
            display: flex;
            gap: 15px;
            justify-content: center;
            flex-wrap: wrap;
        }

        .btn {
            padding: 12px 24px;
            border: none;
            border-radius: 12px;
            font-size: 14px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s ease;
            backdrop-filter: blur(10px);
        }

        .btn-primary {
            background: linear-gradient(45deg, #4299e1, #667eea);
            color: white;
            box-shadow: 0 4px 12px rgba(66, 153, 225, 0.3);
        }

        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(66, 153, 225, 0.4);
        }

        .btn-secondary {
            background: rgba(113, 128, 150, 0.9);
            color: white;
            box-shadow: 0 4px 12px rgba(113, 128, 150, 0.3);
        }

        .btn-secondary:hover {
            transform: translateY(-2px);
            background: rgba(113, 128, 150, 1);
        }

        .btn:disabled {
            opacity: 0.6;
            cursor: not-allowed;
        }

        .pipeline-status {
            margin-top: 30px;
            text-align: center;
            padding: 15px 20px;
            border-radius: 12px;
            font-weight: 600;
            backdrop-filter: blur(10px);
        }

        .pipeline-status.running {
            background: rgba(254, 243, 199, 0.9);
            color: #92400e;
            border: 1px solid #fbbf24;
            box-shadow: 0 4px 12px rgba(251, 191, 36, 0.2);
        }

        .pipeline-status.success {
            background: rgba(209, 250, 229, 0.9);
            color: #064e3b;
            border: 1px solid #10b981;
            box-shadow: 0 4px 12px rgba(16, 185, 129, 0.2);
        }

        .pipeline-status.failed {
            background: rgba(254, 226, 226, 0.9);
            color: #7f1d1d;
            border: 1px solid #ef4444;
            box-shadow: 0 4px 12px rgba(239, 68, 68, 0.2);
        }

        /* Mobile responsiveness */
        @media (max-width: 768px) {
            .pipeline-container {
                padding: 20px;
                margin: 10px;
            }
            
            .pipeline-title {
                font-size: 24px;
                margin-bottom: 30px;
            }
            
            .pipeline-stages {
                height: auto;
                min-height: 600px;
                display: flex;
                flex-direction: column;
                gap: 20px;
                position: relative;
            }
            
            .pipeline-center {
                position: relative;
                top: auto;
                left: auto;
                transform: none;
                margin: 20px auto;
                order: -1;
            }
            
            .stage {
                position: relative;
                width: 100%;
                max-width: 300px;
                margin: 0 auto;
                top: auto !important;
                left: auto !important;
                right: auto !important;
                bottom: auto !important;
            }
            
            .job {
                width: 100%;
                max-width: 280px;
            }
            
            .job-name {
                font-size: 12px;
                white-space: normal;
                line-height: 1.2;
            }
        }

        @media (max-width: 480px) {
            .pipeline-container {
                padding: 15px;
                margin: 5px;
            }
            
            .pipeline-title {
                font-size: 20px;
            }
            
            .job {
                padding: 6px 10px;
            }
            
            .job-name {
                font-size: 11px;
            }
            
            .controls {
                flex-direction: column;
                align-items: center;
            }
            
            .btn {
                width: 100%;
                max-width: 200px;
            }
        }

        /* Modal Styles */
        .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.5);
            display: none;
            justify-content: center;
            align-items: center;
            z-index: 1000;
            backdrop-filter: blur(5px);
        }

        .modal-overlay.show {
            display: flex;
        }

        .modal {
            background: #f0f0f0;
            border-radius: 12px;
            width: 90%;
            max-width: 900px;
            height: 75%;
            max-height: 650px;
            box-shadow: 0 25px 80px rgba(0,0,0,0.3);
            display: flex;
            flex-direction: column;
            overflow: hidden;
            animation: modalSlideIn 0.3s ease-out;
            border: 3px solid #666;
        }

        @keyframes modalSlideIn {
            from {
                opacity: 0;
                transform: scale(0.9) translateY(-20px);
            }
            to {
                opacity: 1;
                transform: scale(1) translateY(0);
            }
        }

        .modal-header {
            background: linear-gradient(135deg, #4a5568 0%, #2d3748 100%);
            padding: 12px 15px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            position: relative;
        }

        .window-controls {
            display: flex;
            gap: 8px;
            align-items: center;
        }

        .window-control {
            width: 14px;
            height: 14px;
            border-radius: 50%;
            border: none;
            cursor: pointer;
        }

        .window-control.close {
            background: #ff5f57;
        }

        .window-control.minimize {
            background: #ffbd2e;
        }

        .window-control.maximize {
            background: #28ca42;
        }

        .window-control:hover {
            opacity: 0.8;
        }

        .modal-url {
            font-family: 'Monaco', 'Menlo', monospace;
            font-size: 13px;
            color: white;
            background: rgba(255, 255, 255, 0.15);
            padding: 6px 12px;
            border-radius: 20px;
            border: 1px solid rgba(255, 255, 255, 0.3);
            flex: 1;
            margin: 0 15px;
            text-align: center;
            backdrop-filter: blur(10px);
        }

        .browser-nav {
            background: #e8e8e8;
            padding: 10px 15px;
            border-bottom: 1px solid #ccc;
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .nav-buttons {
            display: flex;
            gap: 8px;
        }

        .nav-button {
            width: 28px;
            height: 28px;
            border: 1px solid #bbb;
            background: linear-gradient(135deg, #f5f5f5 0%, #e0e0e0 100%);
            border-radius: 4px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 12px;
            color: #666;
        }

        .nav-button:hover {
            background: linear-gradient(135deg, #e0e0e0 0%, #d0d0d0 100%);
        }

        .address-bar {
            flex: 1;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .address-input {
            flex: 1;
            padding: 6px 12px;
            border: 1px solid #ccc;
            border-radius: 20px;
            background: white;
            font-family: 'Monaco', 'Menlo', monospace;
            font-size: 13px;
            outline: none;
        }

        .search-icon {
            width: 20px;
            height: 20px;
            background: #4CAF50;
            border-radius: 3px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 12px;
        }

        .modal-content {
            flex: 1;
            background: white;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            color: #4a5568;
            font-size: 18px;
        }

        .feature-preview {
            width: 100%;
            height: 100%;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            color: white;
            position: relative;
            overflow: hidden;
        }

        .feature-preview::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100"><defs><pattern id="grid" width="10" height="10" patternUnits="userSpaceOnUse"><path d="M 10 0 L 0 0 0 10" fill="none" stroke="%23ffffff" stroke-width="0.5" opacity="0.1"/></pattern></defs><rect width="100" height="100" fill="url(%23grid)"/></svg>');
            opacity: 0.3;
        }

        .feature-preview-content {
            position: relative;
            z-index: 1;
            text-align: center;
        }

        .feature-preview h1 {
            font-size: 32px;
            margin-bottom: 15px;
            font-weight: 700;
        }

        .feature-preview p {
            font-size: 18px;
            opacity: 0.9;
            margin-bottom: 10px;
        }

        .feature-stats {
            display: flex;
            gap: 30px;
            margin-top: 30px;
        }

        .stat {
            text-align: center;
        }

        .stat-number {
            font-size: 24px;
            font-weight: bold;
            color: #ffd700;
        }

        .stat-label {
            font-size: 12px;
            opacity: 0.8;
            margin-top: 5px;
        }

        .cta-section {
            margin-top: 40px;
            padding: 25px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 15px;
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.2);
            text-align: center;
        }

        .cta-title {
            font-size: 18px;
            font-weight: 600;
            margin-bottom: 15px;
            color: white;
            line-height: 1.4;
        }

        .cta-button-modal {
            display: inline-block;
            background: linear-gradient(135deg, #fbbf24 0%, #f59e0b 100%);
            color: #1a202c;
            padding: 12px 24px;
            border-radius: 25px;
            text-decoration: none;
            font-weight: 700;
            font-size: 16px;
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(251, 191, 36, 0.4);
            border: 2px solid rgba(255, 255, 255, 0.3);
        }

        .cta-button-modal:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 25px rgba(251, 191, 36, 0.6);
            color: #1a202c;
            text-decoration: none;
            background: linear-gradient(135deg, #fcd34d 0%, #fbbf24 100%);
        }
        }
    </style>
</head>
<body>
    <!-- Author info banner -->
    <div class="author-banner">
        <p>Work by <strong>Antoine ROUGEOT</strong> (Tony Engineering OÜ) | LinkedIn: <a href="https://www.linkedin.com/in/antoinerougeot/" target="_blank">antoinerougeot</a> | Source: <a href="https://github.com/Tony-Engineering-OU/demo-feature-envs" target="_blank">GitHub</a></p>
    </div>
    <div class="pipeline-container">
        <h1 class="pipeline-title">CI/CD Pipeline Simulation</h1>
        
        
        <div class="feature-url-preview" id="featureUrlPreview">
            <div class="url">feature-123-fix-bug.app.company.ai</div>
            <div class="status" id="featureStatus">Preparing deployment...</div>
        </div>
        
        <div class="pipeline-stages">
            <div class="pipeline-center" id="pipelineCenter" onclick="openFeatureModal()">
                <div class="browser-preview pending" id="browserPreview">
                    <div class="mini-browser-header">
                        <div class="mini-window-control close"></div>
                        <div class="mini-window-control minimize"></div>
                        <div class="mini-window-control maximize"></div>
                        <div class="mini-url-bar">feature-123-fix-bug.app.company.ai</div>
                    </div>
                    <div class="mini-browser-content">
                        <div class="deployment-status pending" id="deploymentStatus">Pending</div>
                        <div class="mini-content-placeholder">
                            🚀 Performance Dashboard<br>
                            <small style="font-size: 9px; opacity: 0.7;">Feature branch deployment</small>
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="stage">
                <div class="stage-header">lint</div>
                <div class="jobs-container">
                    <div class="job pending" data-job="api-eslint">
                        <div class="job-icon">⏸</div>
                        <div class="job-name">api-eslint</div>
                        <div class="job-duration">-</div>
                    </div>
                    <div class="job pending" data-job="check-conventional-commits">
                        <div class="job-icon">⏸</div>
                        <div class="job-name">check-conventional-commits</div>
                        <div class="job-duration">-</div>
                    </div>
                    <div class="job pending" data-job="web-eslint">
                        <div class="job-icon">⏸</div>
                        <div class="job-name">web-eslint</div>
                        <div class="job-duration">-</div>
                    </div>
                </div>
            </div>

            <div class="stage">
                <div class="stage-header">bump</div>
                <div class="jobs-container">
                    <div class="job pending" data-job="bump">
                        <div class="job-icon">⏸</div>
                        <div class="job-name">bump</div>
                        <div class="job-duration">-</div>
                    </div>
                </div>
            </div>

            <div class="stage">
                <div class="stage-header">build</div>
                <div class="jobs-container">
                    <div class="job pending" data-job="build-api">
                        <div class="job-icon">⏸</div>
                        <div class="job-name">build-api</div>
                        <div class="job-duration">-</div>
                    </div>
                    <div class="job pending" data-job="build-database-migrator">
                        <div class="job-icon">⏸</div>
                        <div class="job-name">build-database-migrator</div>
                        <div class="job-duration">-</div>
                    </div>
                    <div class="job pending" data-job="build-random-data-seeder">
                        <div class="job-icon">⏸</div>
                        <div class="job-name">build-random-data-seeder</div>
                        <div class="job-duration">-</div>
                    </div>
                    <div class="job pending" data-job="build-web">
                        <div class="job-icon">⏸</div>
                        <div class="job-name">build-web</div>
                        <div class="job-duration">-</div>
                    </div>
                    <div class="job pending" data-job="build-web-e2e-tests">
                        <div class="job-icon">⏸</div>
                        <div class="job-name">build-web-e2e-tests</div>
                        <div class="job-duration">-</div>
                    </div>
                    <div class="job pending" data-job="build-web-maintenance">
                        <div class="job-icon">⏸</div>
                        <div class="job-name">build-web-maintenance</div>
                        <div class="job-duration">-</div>
                    </div>
                </div>
            </div>

            <div class="stage">
                <div class="stage-header">unit-tests</div>
                <div class="jobs-container">
                    <div class="job pending" data-job="unit-tests">
                        <div class="job-icon">⏸</div>
                        <div class="job-name">unit-tests</div>
                        <div class="job-duration">-</div>
                    </div>
                </div>
            </div>

            <div class="stage">
                <div class="stage-header">components-tests</div>
                <div class="jobs-container">
                    <div class="job pending" data-job="web-components-tests">
                        <div class="job-icon">⏸</div>
                        <div class="job-name">web-components-tests</div>
                        <div class="job-duration">-</div>
                    </div>
                </div>
            </div>

            <div class="stage">
                <div class="stage-header">e2e-tests</div>
                <div class="jobs-container">
                    <div class="job pending" data-job="api-e2e-tests">
                        <div class="job-icon">⏸</div>
                        <div class="job-name">api-e2e-tests</div>
                        <div class="job-duration">-</div>
                    </div>
                    <div class="job pending" data-job="web-e2e-tests">
                        <div class="job-icon">⏸</div>
                        <div class="job-name">web-e2e-tests</div>
                        <div class="job-duration">-</div>
                    </div>
                </div>
            </div>

            <div class="stage">
                <div class="stage-header">post-release</div>
                <div class="jobs-container">
                    <div class="job pending" data-job="publish-helm-chart-for-feature-environment">
                        <div class="job-icon">⏸</div>
                        <div class="job-name">publish-helm-chart-for-feature-environment</div>
                        <div class="job-duration">-</div>
                    </div>
                </div>
            </div>

            <div class="stage">
                <div class="stage-header">deploy</div>
                <div class="jobs-container">
                    <div class="job pending" data-job="deploy-to-feature-environment">
                        <div class="job-icon">⏸</div>
                        <div class="job-name">deploy-to-feature-environment</div>
                        <div class="job-duration">-</div>
                    </div>
                </div>
            </div>

            <div class="stage">
                <div class="stage-header">post-deploy</div>
                <div class="jobs-container">
                    <div class="job pending" data-job="link-with-another-db">
                        <div class="job-icon">⏸</div>
                        <div class="job-name">link-with-another-db</div>
                        <div class="job-duration">-</div>
                    </div>
                    <div class="job pending" data-job="link-with-prod-db">
                        <div class="job-icon">⏸</div>
                        <div class="job-name">link-with-prod-db</div>
                        <div class="job-duration">-</div>
                    </div>
                    <div class="job pending" data-job="stop-environment">
                        <div class="job-icon">⏸</div>
                        <div class="job-name">stop-environment</div>
                        <div class="job-duration">-</div>
                    </div>
                    <div class="job pending" data-job="run-debug-feature">
                        <div class="job-icon">⏸</div>
                        <div class="job-name">run-debug-feature</div>
                        <div class="job-duration">-</div>
                    </div>
                </div>
            </div>
        </div>

            <div class="cta-section">
                            <a href="https://calendly.com/tony-engineering/prise-connaissance" target="_blank" class="cta-button-modal">
                                Book a chat with me
                            </a>
                        </div>

        <div class="pipeline-status" id="pipelineStatus" style="display: none;"></div>
    </div>

    <!-- Feature Environment Modal -->
    <div class="modal-overlay" id="featureModal">
        <div class="modal">
            <div class="modal-header">
                <div class="window-controls">
                    <button class="window-control close" onclick="closeFeatureModal()"></button>
                    <button class="window-control minimize"></button>
                    <button class="window-control maximize"></button>
                </div>
                <div class="modal-url">feature-123-fix-bug.app.company.ai</div>
                <div style="width: 70px;"></div> <!-- Spacer for centering -->
            </div>
            <div class="modal-content">
                <div class="feature-preview">
                    <div class="feature-preview-content">
                        <h1>🚀 New feature environment created !</h1>
                        <p>Feature environment deployed successfully</p>
                        <p>You can now send the feature env link to a colleague for preview</p>
                        
                        
                        <div class="cta-section">
                            <div class="cta-title">
                                Want this for your team?<br>
                                Let's discuss your current DevOps challenges:
                            </div>
                            <a href="https://calendly.com/tony-engineering/prise-connaissance" target="_blank" class="cta-button-modal">
                                Book a chat with me
                            </a>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Job dependencies and timing configuration (80% faster than original - ultra-fast demo)
        const jobConfig = {
            // Lint stage
            'api-eslint': { dependencies: [], duration: 490, manual: false },
            'check-conventional-commits': { dependencies: [], duration: 370, manual: false },
            'web-eslint': { dependencies: [], duration: 610, manual: false },
            
            // Bump stage - depends on lint
            'bump': { dependencies: ['api-eslint', 'check-conventional-commits', 'web-eslint'], duration: 735, manual: false },
            
            // Build stage - depends on bump
            'build-api': { dependencies: ['bump'], duration: 980, manual: false },
            'build-database-migrator': { dependencies: ['bump'], duration: 860, manual: false },
            'build-random-data-seeder': { dependencies: ['bump'], duration: 735, manual: false },
            'build-web': { dependencies: ['bump'], duration: 1225, manual: false },
            'build-web-e2e-tests': { dependencies: ['bump'], duration: 1100, manual: false },
            'build-web-maintenance': { dependencies: ['bump'], duration: 860, manual: false },
            
            // Unit tests - depends on builds
            'unit-tests': { dependencies: ['build-api', 'build-web'], duration: 1470, manual: false },
            
            // Components tests - depends on web build
            'web-components-tests': { dependencies: ['build-web'], duration: 980, manual: false },
            
            // E2E tests - depends on various builds
            'api-e2e-tests': { dependencies: ['build-api', 'build-database-migrator'], duration: 1960, manual: false },
            'web-e2e-tests': { dependencies: ['build-web', 'build-web-e2e-tests'], duration: 2450, manual: false },
            
            // Post-release - depends on tests
            'publish-helm-chart-for-feature-environment': { 
                dependencies: ['unit-tests', 'web-components-tests', 'api-e2e-tests', 'web-e2e-tests'], 
                duration: 735,
                manual: false
            },
            
            // Deploy - depends on post-release
            'deploy-to-feature-environment': { 
                dependencies: ['publish-helm-chart-for-feature-environment'], 
                duration: 1225,
                manual: false
            },
            
            // Post-deploy - manual jobs that need user interaction
            'link-with-another-db': { dependencies: ['deploy-to-feature-environment'], duration: 0, manual: true },
            'link-with-prod-db': { dependencies: ['deploy-to-feature-environment'], duration: 0, manual: true },
            'stop-environment': { dependencies: ['deploy-to-feature-environment'], duration: 0, manual: true },
            'run-debug-feature': { dependencies: ['deploy-to-feature-environment'], duration: 735, manual: false }
        };

        let jobStates = {};
        let jobStartTimes = {};
        let pipelineRunning = false;
        let deploymentState = 'pending'; // pending, loading, deployed

        function initializePipeline() {
            Object.keys(jobConfig).forEach(jobName => {
                jobStates[jobName] = 'pending';
            });
        }

        function updateJobUI(jobName, state, duration = null) {
            const jobElement = document.querySelector(`[data-job="${jobName}"]`);
            if (!jobElement) return;

            // Update classes
            const jobData = jobConfig[jobName];
            if (jobData && jobData.manual && state !== 'running') {
                jobElement.className = `job manual`;
            } else {
                jobElement.className = `job ${state}`;
            }
            
            // Update icon
            const iconElement = jobElement.querySelector('.job-icon');
            const durationElement = jobElement.querySelector('.job-duration');
            
            switch(state) {
                case 'pending':
                    if (jobData && jobData.manual) {
                        iconElement.innerHTML = '👤';
                        durationElement.textContent = 'Manual';
                    } else {
                        iconElement.innerHTML = '⏸';
                        durationElement.textContent = '-';
                    }
                    break;
                case 'running':
                    iconElement.innerHTML = '<div class="spinner"></div>';
                    durationElement.textContent = 'Running...';
                    break;
                case 'success':
                    iconElement.innerHTML = '✓';
                    durationElement.textContent = duration ? `${Math.round(duration/1000)}s` : 'Done';
                    break;
                case 'manual':
                    iconElement.innerHTML = '👤';
                    durationElement.textContent = 'Manual';
                    break;
            }
        }

        function updatePipelineStatus() {
            const statusElement = document.getElementById('pipelineStatus');
            const centerElement = document.getElementById('pipelineCenter');
            const allJobs = Object.keys(jobStates);
            const completedJobs = allJobs.filter(job => jobStates[job] === 'success');
            const manualJobs = allJobs.filter(job => jobStates[job] === 'manual');
            const runningJobs = allJobs.filter(job => jobStates[job] === 'running');
            const finishedJobs = completedJobs.length + manualJobs.length;

            statusElement.style.display = 'block';

            if (finishedJobs === allJobs.length) {
                statusElement.className = 'pipeline-status success';
                statusElement.textContent = `Pipeline Completed Successfully - ${completedJobs.length} automated, ${manualJobs.length} manual jobs`;
                pipelineRunning = false;
                centerElement.classList.remove('active');
            } else if (runningJobs.length > 0 || pipelineRunning) {
                statusElement.className = 'pipeline-status running';
                statusElement.textContent = `Pipeline Running - ${finishedJobs}/${allJobs.length} jobs completed`;
                centerElement.classList.add('active');
            }
        }

        function canJobRun(jobName) {
            const dependencies = jobConfig[jobName].dependencies;
            return dependencies.every(dep => jobStates[dep] === 'success' || jobStates[dep] === 'manual');
        }

        function runJob(jobName) {
            if (!canJobRun(jobName) || jobStates[jobName] !== 'pending') {
                return;
            }

            const jobData = jobConfig[jobName];
            
            // Handle deploy job starting
            if (jobName === 'deploy-to-feature-environment') {
                deploymentState = 'loading';
                updateCenterIcon();
            }
            
            // Handle manual jobs
            if (jobData.manual) {
                jobStates[jobName] = 'manual';
                updateJobUI(jobName, 'manual');
                updatePipelineStatus();
                
                // Still trigger dependent jobs for manual jobs
                setTimeout(() => {
                    Object.keys(jobConfig).forEach(dependentJob => {
                        if (jobConfig[dependentJob].dependencies.includes(jobName)) {
                            runJob(dependentJob);
                        }
                    });
                }, 1000);
                return;
            }

            jobStates[jobName] = 'running';
            jobStartTimes[jobName] = Date.now();
            updateJobUI(jobName, 'running');

            const duration = jobData.duration;

            setTimeout(() => {
                const actualDuration = Date.now() - jobStartTimes[jobName];
                
                jobStates[jobName] = 'success';
                updateJobUI(jobName, 'success', actualDuration);
                
                // Handle deploy job completion
                if (jobName === 'deploy-to-feature-environment') {
                    deploymentState = 'deployed';
                    updateCenterIcon();
                    // Show modal after a short delay
                    setTimeout(() => {
                        openFeatureModal();
                    }, 1000);
                }
                
                // Trigger dependent jobs
                setTimeout(() => {
                    Object.keys(jobConfig).forEach(dependentJob => {
                        if (jobConfig[dependentJob].dependencies.includes(jobName)) {
                            runJob(dependentJob);
                        }
                    });
                }, 500); // Small delay between dependent jobs
                
                updatePipelineStatus();
            }, duration);
        }

        function startPipeline() {
            if (pipelineRunning) return;
            
            pipelineRunning = true;
            initializePipeline();
            
            // Reset UI
            Object.keys(jobConfig).forEach(jobName => {
                updateJobUI(jobName, 'pending');
            });
            
            updatePipelineStatus();
            
            // Start jobs with no dependencies
            Object.keys(jobConfig).forEach(jobName => {
                if (jobConfig[jobName].dependencies.length === 0) {
                    // Add small random delays to make it more realistic
                    setTimeout(() => runJob(jobName), Math.random() * 1000);
                }
            });
        }

        function resetPipeline() {
            pipelineRunning = false;
            deploymentState = 'pending';
            initializePipeline();
            
            Object.keys(jobConfig).forEach(jobName => {
                updateJobUI(jobName, 'pending');
            });
            
            updateCenterIcon();
            closeFeatureModal();
            
            const statusElement = document.getElementById('pipelineStatus');
            statusElement.style.display = 'none';
        }

        function updateCenterIcon() {
            const browserPreview = document.getElementById('browserPreview');
            const deploymentStatus = document.getElementById('deploymentStatus');
            const featureUrlPreview = document.getElementById('featureUrlPreview');
            const featureStatus = document.getElementById('featureStatus');
            
            browserPreview.className = `browser-preview ${deploymentState}`;
            deploymentStatus.className = `deployment-status ${deploymentState}`;
            
            switch(deploymentState) {
                case 'pending':
                    deploymentStatus.textContent = 'Pending';
                    featureStatus.textContent = 'Preparing deployment...';
                    featureUrlPreview.classList.remove('deployed');
                    break;
                case 'loading':
                    deploymentStatus.textContent = 'Loading';
                    featureStatus.textContent = 'Deployment in progress...';
                    featureUrlPreview.classList.remove('deployed');
                    break;
                case 'deployed':
                    deploymentStatus.textContent = 'Deployed';
                    featureStatus.textContent = '✓ Deployed and ready for testing';
                    featureUrlPreview.classList.add('deployed');
                    break;
            }
        }

        function openFeatureModal() {
            if (deploymentState === 'deployed') {
                const modal = document.getElementById('featureModal');
                modal.classList.add('show');
            }
        }

        function closeFeatureModal() {
            const modal = document.getElementById('featureModal');
            modal.classList.remove('show');
        }

        // Close modal when clicking outside
        document.getElementById('featureModal').addEventListener('click', function(e) {
            if (e.target === this) {
                closeFeatureModal();
            }
        });

        // Initialize on page load
        document.addEventListener('DOMContentLoaded', () => {
            initializePipeline();
            
            // Auto-start the pipeline after a short delay
            setTimeout(startPipeline, 1000);
        });
    </script>
</body>
</html>
